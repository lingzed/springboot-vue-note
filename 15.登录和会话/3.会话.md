# 什么是会话

> 在web开发中，所谓的会话指，用户打开浏览器，访问web服务器的资源，会话建立，直到有一-方断开连接，会话结束。在一次会话中可以包含<font color='red'>多次</font>请求和响应。
>
> 即浏览器与服务器的一次连接称谓会话。
>
> 用户使用浏览器第一次发送请求到服务器，会话就开始了，直到任何一方断开连接，会话才结束，需要注意的是并不是一次请求和响应才是一次会话，而是服务器与浏览器的一次连接才叫做一次会话，既然如此，一次会话中肯定可以包含多次请求。

![image-20240509190133251](assets/image-20240509190133251.png)

> 当多个浏览器同时访问服务器时，如3个浏览器同时访问服务器：

![image-20240509190433357](assets/image-20240509190433357.png)

> 浏览器A发送1个请求，浏览器B发送3个请求，浏览器C发送1个请求，建立的会话其实是3个会话，因为有3个浏览器与服务器建立连接，可见会话是与浏览器关联起来的。
>
> 同一个浏览器在未关闭之前请求了多次服务器，这多次请求是同一个会话。关闭浏览器，本次会话结束，关闭服务器，所有会话都结束。



# 会话跟踪

> 会话跟踪：一种维护浏览器状态的方法，服务器需要识别多次请求是否来自于同一浏览器，以便在同一次会话的多次请求间<font color='red'>共享数据</font>。
>
> 服务器会接收很多请求，但是服务器需要识别这些请求是不是同一个浏览器发出的，比如请求1和请求2是否是同一浏览器发出的，3和5又是否是同一浏览器发出的：

![image-20240509191339455](assets/image-20240509191339455.png)

> 如果是同一个浏览器发出的，说明是同一次会话，否则是不同的会话。而识别是否是同一个浏览器发出的请求的过程，就叫做会话跟踪。
>
> 多次请求来自同一个会话，那么我们就可以在多次请求之间共享数据了。
>
> 为何要共享数据？
>
> 比如阿里云系统，我们登录成功后，系统会显示我们的用户名信息，当我们操作A功能时发送A请求，操作B功能时又是一次B请求，登录是一次请求，而A、B请求以及后续的请求是如何拿到用户名信息的呢？那就需要在一次会话的多次请求之间共享数据了。
>
> 又比如登录验证码校验时，获取验证码是一次请求，而登录也是一次请求，登录时需要将输入的验证码与上一次请求得到的验证码进行对比。第二次请求需要第一次的验证码，因此需要共享数据。



# 解决方案

> 浏览器使用HTTP协议，HTTP协议无状态，每次请求相互独立，下一次请求无法携带上一次请求的数据，这也保证了请求速度很快，也因此我们无法仅通过HTTP协议来判断多次请求是否是同一次会话。
>
> 解决方案又3种：
>
> - 客户端会话跟踪技术：Cookie
> - 服务端会话跟踪技术：Session
> - 令牌技术
>
> Cookie是客户端会话跟踪技术，因此是存储在服务器端的，而Session则相反，它存储在服务器端。Cookie和Session是传统web开发中提供的解决方案，而令牌技术是现在的主流解决方案。